import{a1 as Et,a2 as Rt,a3 as Lt,a4 as St,a5 as Dt,H as Mt,j as Pt,a6 as Tt,x as At,A as Wt,E as zt,M as Ot,z as We}from"./FullscreenButton-D7OpqaEU.js";import"./init-BXnIR-ED.js";import{H as me}from"./hls-C7-VjdhD.js";var Ht=function(s,e,t,i){function n(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(l){try{d(i.next(l))}catch(c){o(c)}}function u(l){try{d(i.throw(l))}catch(c){o(c)}}function d(l){l.done?r(l.value):n(l.value).then(a,u)}d((i=i.apply(s,e||[])).next())})};function Nt(s,e){return Ht(this,void 0,void 0,function*(){const t=new AudioContext({sampleRate:e});return t.decodeAudioData(s).finally(()=>t.close())})}function Vt(s){const e=s[0];if(e.some(t=>t>1||t<-1)){const t=e.length;let i=0;for(let n=0;n<t;n++){const r=Math.abs(e[n]);r>i&&(i=r)}for(const n of s)for(let r=0;r<t;r++)n[r]/=i}return s}function jt(s,e){return typeof s[0]=="number"&&(s=[s]),Vt(s),{duration:e,length:s[0].length,sampleRate:s[0].length/e,numberOfChannels:s.length,getChannelData:t=>s?.[t],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}const Ne={decode:Nt,createBuffer:jt};var Qe=function(s,e,t,i){function n(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(l){try{d(i.next(l))}catch(c){o(c)}}function u(l){try{d(i.throw(l))}catch(c){o(c)}}function d(l){l.done?r(l.value):n(l.value).then(a,u)}d((i=i.apply(s,e||[])).next())})};function Bt(s,e,t){var i,n;return Qe(this,void 0,void 0,function*(){const r=yield fetch(s,t);{const o=(i=r.clone().body)===null||i===void 0?void 0:i.getReader(),a=Number((n=r.headers)===null||n===void 0?void 0:n.get("Content-Length"));let u=0;const d=(l,c)=>Qe(this,void 0,void 0,function*(){if(l)return;u+=c?.length||0;const v=Math.round(u/a*100);return e(v),o?.read().then(({done:h,value:f})=>d(h,f))});o?.read().then(({done:l,value:c})=>d(l,c))}return r.blob()})}const It={fetchBlob:Bt};class Oe{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener}addEventListener(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i?.once){const n=()=>{this.removeEventListener(e,n),this.removeEventListener(e,t)};return this.addEventListener(e,n),n}return()=>this.removeEventListener(e,t)}removeEventListener(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}}class Ut extends Oe{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onceMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)})}onMediaEvent(e,t,i){return this.media.addEventListener(e,t,i),()=>this.media.removeEventListener(e,t)}onceMediaEvent(e,t){return this.onMediaEvent(e,t,{once:!0})}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}setSrc(e,t){if(this.getSrc()===e)return;this.revokeSrc();const n=t instanceof Blob?URL.createObjectURL(t):e;this.media.src=n,this.media.load()}destroy(){this.media.pause(),!this.isExternalMedia&&(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return this.media.play()}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=e}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}setPlaybackRate(e,t){t!=null&&(this.media.preservesPitch=t),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}function qt(s,e,t,i,n=5){let r=()=>{};if(!s)return r;const o=a=>{if(a.button===2)return;a.preventDefault(),a.stopPropagation(),s.style.touchAction="none";let u=a.clientX,d=a.clientY,l=!1;const c=f=>{f.preventDefault(),f.stopPropagation();const b=f.clientX,D=f.clientY;if(l||Math.abs(b-u)>=n||Math.abs(D-d)>=n){const{left:P,top:E}=s.getBoundingClientRect();l||(l=!0,t?.(u-P,d-E)),e(b-u,D-d,b-P,D-E),u=b,d=D}},v=f=>{l&&(f.preventDefault(),f.stopPropagation())},h=()=>{s.style.touchAction="",l&&i?.(),r()};document.addEventListener("pointermove",c),document.addEventListener("pointerup",h),document.addEventListener("pointerleave",h),document.addEventListener("click",v,!0),r=()=>{document.removeEventListener("pointermove",c),document.removeEventListener("pointerup",h),document.removeEventListener("pointerleave",h),setTimeout(()=>{document.removeEventListener("click",v,!0)},10)}};return s.addEventListener("pointerdown",o),()=>{r(),s.removeEventListener("pointerdown",o)}}class He extends Oe{constructor(e,t){super(),this.timeouts=[],this.isScrolling=!1,this.audioData=null,this.resizeObserver=null,this.isDragging=!1,this.options=e;const i=this.parentFromOptionsContainer(e.container);this.parent=i;const[n,r]=this.initHtml();i.appendChild(n),this.container=n,this.scrollContainer=r.querySelector(".scroll"),this.wrapper=r.querySelector(".wrapper"),this.canvasWrapper=r.querySelector(".canvases"),this.progressWrapper=r.querySelector(".progress"),this.cursor=r.querySelector(".cursor"),t&&r.appendChild(t),this.initEvents()}parentFromOptionsContainer(e){let t;if(typeof e=="string"?t=document.querySelector(e):e instanceof HTMLElement&&(t=e),!t)throw new Error("Container not found");return t}initEvents(){const e=i=>{const n=this.wrapper.getBoundingClientRect(),r=i.clientX-n.left,o=i.clientX-n.left,a=r/n.width,u=o/n.height;return[a,u]};this.wrapper.addEventListener("click",i=>{const[n,r]=e(i);this.emit("click",n,r)}),this.wrapper.addEventListener("dblclick",i=>{const[n,r]=e(i);this.emit("dblclick",n,r)}),this.options.dragToSeek&&this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:i,scrollWidth:n,clientWidth:r}=this.scrollContainer,o=i/n,a=(i+r)/n;this.emit("scroll",o,a)});const t=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{t(()=>this.reRender())}),this.resizeObserver.observe(this.scrollContainer)}initDrag(){qt(this.wrapper,(e,t,i)=>{this.emit("drag",Math.max(0,Math.min(1,i/this.wrapper.getBoundingClientRect().width)))},()=>this.isDragging=!0,()=>this.isDragging=!1)}getHeight(){return this.options.height==null?128:isNaN(Number(this.options.height))?this.options.height==="auto"&&this.parent.clientHeight||128:Number(this.options.height)}initHtml(){const e=document.createElement("div"),t=e.attachShadow({mode:"open"});return t.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight()}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,t]}setOptions(e){if(this.options.container!==e.container){const t=this.parentFromOptionsContainer(e.container);t.appendChild(this.container),this.parent=t}e.dragToSeek&&!this.options.dragToSeek&&this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getScroll(){return this.scrollContainer.scrollLeft}destroy(){var e;this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect()}createDelay(e=10){const t={};return this.timeouts.push(t),i=>{t.timeout&&clearTimeout(t.timeout),t.timeout=setTimeout(i,e)}}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";const t=document.createElement("canvas"),n=t.getContext("2d").createLinearGradient(0,0,0,t.height),r=1/(e.length-1);return e.forEach((o,a)=>{const u=a*r;n.addColorStop(u,o)}),n}renderBarWaveform(e,t,i,n){const r=e[0],o=e[1]||e[0],a=r.length,{width:u,height:d}=i.canvas,l=d/2,c=window.devicePixelRatio||1,v=t.barWidth?t.barWidth*c:1,h=t.barGap?t.barGap*c:t.barWidth?v/2:0,f=t.barRadius||0,b=u/(v+h)/a,D=f&&"roundRect"in i?"roundRect":"rect";i.beginPath();let P=0,E=0,p=0;for(let L=0;L<=a;L++){const C=Math.round(L*b);if(C>P){const A=Math.round(E*l*n),j=Math.round(p*l*n),H=A+j||1;let g=l-A;t.barAlign==="top"?g=0:t.barAlign==="bottom"&&(g=d-H),i[D](P*(v+h),g,v,H,f),P=C,E=0,p=0}const w=Math.abs(r[L]||0),y=Math.abs(o[L]||0);w>E&&(E=w),y>p&&(p=y)}i.fill(),i.closePath()}renderLineWaveform(e,t,i,n){const r=o=>{const a=e[o]||e[0],u=a.length,{height:d}=i.canvas,l=d/2,c=i.canvas.width/u;i.moveTo(0,l);let v=0,h=0;for(let f=0;f<=u;f++){const b=Math.round(f*c);if(b>v){const P=Math.round(h*l*n)||1,E=l+P*(o===0?-1:1);i.lineTo(v,E),v=b,h=0}const D=Math.abs(a[f]||0);D>h&&(h=D)}i.lineTo(v,l)};i.beginPath(),r(0),r(1),i.fill(),i.closePath()}renderWaveform(e,t,i){if(i.fillStyle=this.convertColorValues(t.waveColor),t.renderFunction){t.renderFunction(e,i);return}let n=t.barHeight||1;if(t.normalize){const r=Array.from(e[0]).reduce((o,a)=>Math.max(o,Math.abs(a)),0);n=r?1/r:1}if(t.barWidth||t.barGap||t.barAlign){this.renderBarWaveform(e,t,i,n);return}this.renderLineWaveform(e,t,i,n)}renderSingleCanvas(e,t,i,n,r,o,a,u){const d=window.devicePixelRatio||1,l=document.createElement("canvas"),c=e[0].length;l.width=Math.round(i*(o-r)/c),l.height=n*d,l.style.width=`${Math.floor(l.width/d)}px`,l.style.height=`${n}px`,l.style.left=`${Math.floor(r*i/d/c)}px`,a.appendChild(l);const v=l.getContext("2d");if(this.renderWaveform(e.map(h=>h.slice(r,o)),t,v),l.width>0&&l.height>0){const h=l.cloneNode(),f=h.getContext("2d");f.drawImage(l,0,0),f.globalCompositeOperation="source-in",f.fillStyle=this.convertColorValues(t.progressColor),f.fillRect(0,0,l.width,l.height),u.appendChild(h)}}renderChannel(e,t,i){const n=document.createElement("div"),r=this.getHeight();n.style.height=`${r}px`,this.canvasWrapper.style.minHeight=`${r}px`,this.canvasWrapper.appendChild(n);const o=n.cloneNode();this.progressWrapper.appendChild(o);const{scrollLeft:a,scrollWidth:u,clientWidth:d}=this.scrollContainer,l=e[0].length,c=l/u;let v=Math.min(He.MAX_CANVAS_WIDTH,d);if(t.barWidth||t.barGap){const C=t.barWidth||.5,w=t.barGap||C/2,y=C+w;v%y!==0&&(v=Math.floor(v/y)*y)}const h=Math.floor(Math.abs(a)*c),f=Math.floor(h+v*c),b=f-h,D=(C,w)=>{this.renderSingleCanvas(e,t,i,r,Math.max(0,C),Math.min(w,l),n,o)},P=this.createDelay(),E=this.createDelay(),p=(C,w)=>{D(C,w),C>0&&P(()=>{p(C-b,w-b)})},L=(C,w)=>{D(C,w),w<l&&E(()=>{L(C+b,w+b)})};p(h,f),f<l&&L(f,f+b)}render(e){this.timeouts.forEach(a=>a.timeout&&clearTimeout(a.timeout)),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.wrapper.style.width="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const t=window.devicePixelRatio||1,i=this.scrollContainer.clientWidth,n=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrolling=n>i;const r=this.options.fillParent&&!this.isScrolling,o=(r?i:n)*t;if(this.wrapper.style.width=r?"100%":`${n}px`,this.scrollContainer.style.overflowX=this.isScrolling?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.options.splitChannels)for(let a=0;a<e.numberOfChannels;a++){const u=Object.assign(Object.assign({},this.options),this.options.splitChannels[a]);this.renderChannel([e.getChannelData(a)],u,o)}else{const a=[e.getChannelData(0)];e.numberOfChannels>1&&a.push(e.getChannelData(1)),this.renderChannel(a,this.options,o)}this.audioData=e,this.emit("render")}reRender(){if(!this.audioData)return;const e=this.progressWrapper.clientWidth;this.render(this.audioData);const t=this.progressWrapper.clientWidth;this.scrollContainer.scrollLeft+=t-e}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,t=!1){const{clientWidth:i,scrollLeft:n,scrollWidth:r}=this.scrollContainer,o=r*e,a=i/2,u=t&&this.options.autoCenter&&!this.isDragging?a:i;if(o>n+u||o<n)if(this.options.autoCenter&&!this.isDragging){const d=a/20;o-(n+a)>=d&&o<n+i?this.scrollContainer.scrollLeft+=d:this.scrollContainer.scrollLeft=o-a}else this.isDragging?this.scrollContainer.scrollLeft=o<n?o-10:o-i+10:this.scrollContainer.scrollLeft=o;{const{scrollLeft:d}=this.scrollContainer,l=d/r,c=(d+i)/r;this.emit("scroll",l,c)}}renderProgress(e,t){if(isNaN(e))return;const i=e*100;this.canvasWrapper.style.clipPath=`polygon(${i}% 0, 100% 0, 100% 100%, ${i}% 100%)`,this.progressWrapper.style.width=`${i}%`,this.cursor.style.left=`${i}%`,this.cursor.style.marginLeft=Math.round(i)===100?`-${this.options.cursorWidth}px`:"",this.isScrolling&&this.options.autoScroll&&this.scrollIntoView(e,t)}}He.MAX_CANVAS_WIDTH=4e3;class Ft extends Oe{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}var Ve=function(s,e,t,i){function n(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(l){try{d(i.next(l))}catch(c){o(c)}}function u(l){try{d(i.throw(l))}catch(c){o(c)}}function d(l){l.done?r(l.value):n(l.value).then(a,u)}d((i=i.apply(s,e||[])).next())})};class xt extends Oe{constructor(e=new AudioContext){super(),this.bufferNode=null,this.autoplay=!1,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return Ve(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){this.currentSrc=e,fetch(e).then(t=>t.arrayBuffer()).then(t=>this.audioContext.decodeAudioData(t)).then(t=>{this.buffer=t,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play()})}_play(){var e;this.paused&&(this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.bufferNode.buffer=this.buffer,this.bufferNode.connect(this.gainNode),this.playedDuration>=this.duration&&(this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,this.playedDuration),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))})}_pause(){var e;this.paused||(this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime)}play(){return Ve(this,void 0,void 0,function*(){this._play(),this.emit("play")})}pause(){this._pause(),this.emit("pause")}setSinkId(e){return Ve(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){var e,t;return(t=(e=this.bufferNode)===null||e===void 0?void 0:e.playbackRate.value)!==null&&t!==void 0?t:1}set playbackRate(e){this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return this.paused?this.playedDuration:this.playedDuration+this.audioContext.currentTime-this.playStartTime}set currentTime(e){this.emit("seeking"),this.paused?this.playedDuration=e:(this._pause(),this.playedDuration=e,this._play()),this.emit("timeupdate")}get duration(){var e;return((e=this.buffer)===null||e===void 0?void 0:e.duration)||0}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}getGainNode(){return this.gainNode}}var ge=function(s,e,t,i){function n(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(l){try{d(i.next(l))}catch(c){o(c)}}function u(l){try{d(i.throw(l))}catch(c){o(c)}}function d(l){l.done?r(l.value):n(l.value).then(a,u)}d((i=i.apply(s,e||[])).next())})};const Xt={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class Ie extends Ut{static create(e){return new Ie(e)}constructor(e){const t=e.media||(e.backend==="WebAudio"?new xt:void 0);super({media:t,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.options=Object.assign({},Xt,e),this.timer=new Ft;const i=t?void 0:this.getMediaElement();this.renderer=new He(this.options,i),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const n=this.options.url||this.getSrc();n?this.load(n,this.options.peaks,this.options.duration):this.options.peaks&&this.options.duration&&this.loadPredecoded()}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{const e=this.getCurrentTime();this.renderer.renderProgress(e/this.getDuration(),!0),this.emit("timeupdate",e),this.emit("audioprocess",e)}))}initPlayerEvents(){this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.getCurrentTime();this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,t)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,t))}),this.renderer.on("dblclick",(e,t)=>{this.emit("dblclick",e,t)}),this.renderer.on("scroll",(e,t)=>{const i=this.getDuration();this.emit("scroll",e*i,t*i)}),this.renderer.on("render",()=>{this.emit("redraw")}));{let e;this.subscriptions.push(this.renderer.on("drag",t=>{this.options.interact&&(this.renderer.renderProgress(t),clearTimeout(e),e=setTimeout(()=>{this.seekTo(t)},this.isPlaying()?0:200),this.emit("interaction",t*this.getDuration()),this.emit("drag",t))}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(t=>{this.registerPlugin(t)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e.init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(t=>t!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getScroll(){return this.renderer.getScroll()}getActivePlugins(){return this.plugins}loadPredecoded(){return ge(this,void 0,void 0,function*(){this.options.peaks&&this.options.duration&&(this.decodedData=Ne.createBuffer(this.options.peaks,this.options.duration),yield Promise.resolve(),this.renderDecoded())})}renderDecoded(){return ge(this,void 0,void 0,function*(){this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData))})}loadAudio(e,t,i,n){return ge(this,void 0,void 0,function*(){if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!t&&!i){const r=o=>this.emit("loading",o);t=yield It.fetchBlob(e,r,this.options.fetchParams)}if(this.setSrc(e,t),n=(yield Promise.resolve(n||this.getDuration()))||(yield new Promise(r=>{this.onceMediaEvent("loadedmetadata",()=>r(this.getDuration()))}))||(yield Promise.resolve(0)),i)this.decodedData=Ne.createBuffer(i,n);else if(t){const r=yield t.arrayBuffer();this.decodedData=yield Ne.decode(r,this.options.sampleRate)}this.renderDecoded(),this.emit("ready",this.getDuration())})}load(e,t,i){return ge(this,void 0,void 0,function*(){yield this.loadAudio(e,void 0,t,i)})}loadBlob(e,t,i){return ge(this,void 0,void 0,function*(){yield this.loadAudio("blob",e,t,i)})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:t=8e3,precision:i=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const n=Math.min(e,this.decodedData.numberOfChannels),r=[];for(let o=0;o<n;o++){const a=this.decodedData.getChannelData(o),u=[],d=Math.round(a.length/t);for(let l=0;l<t;l++){const c=a.slice(l*d,(l+1)*d),v=Math.max(...c);u.push(Math.round(v*i)/i)}r.push(u)}return r}getDuration(){let e=super.getDuration()||0;return(e===0||e===1/0)&&this.decodedData&&(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}seekTo(e){const t=this.getDuration()*e;this.setTime(t)}playPause(){return ge(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}destroy(){this.emit("destroy"),this.plugins.forEach(e=>e.destroy()),this.subscriptions.forEach(e=>e()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}function Gt(s){const e=s.numberOfChannels,t=s.length*e*2+44,i=new ArrayBuffer(t),n=new DataView(i);let r=0;const o=function(a,u,d){for(let l=0;l<d.length;l++)a.setUint8(u+l,d.charCodeAt(l))};o(n,r,"RIFF"),r+=4,n.setUint32(r,t-8,!0),r+=4,o(n,r,"WAVE"),r+=4,o(n,r,"fmt "),r+=4,n.setUint32(r,16,!0),r+=4,n.setUint16(r,1,!0),r+=2,n.setUint16(r,e,!0),r+=2,n.setUint32(r,s.sampleRate,!0),r+=4,n.setUint32(r,s.sampleRate*2*e,!0),r+=4,n.setUint16(r,e*2,!0),r+=2,n.setUint16(r,16,!0),r+=2,o(n,r,"data"),r+=4,n.setUint32(r,s.length*e*2,!0),r+=4;for(let a=0;a<s.length;a++)for(let u=0;u<e;u++){const d=Math.max(-1,Math.min(1,s.getChannelData(u)[a]));n.setInt16(r,d*32767,!0),r+=2}return new Uint8Array(i)}const Yt=async(s,e,t,i)=>{const n=new AudioContext({sampleRate:i||s.sampleRate}),r=s.numberOfChannels,o=i||s.sampleRate;let a=s.length,u=0;e&&t&&(u=Math.round(e*o),a=Math.round(t*o)-u);const d=n.createBuffer(r,a,o);for(let l=0;l<r;l++){const c=s.getChannelData(l),v=d.getChannelData(l);for(let h=0;h<a;h++)v[h]=c[u+h]}return Gt(d)},Ze=(s,e)=>{s&&s.skip(e)},ve=(s,e)=>(e||(e=5),s/100*e||5);class gt{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener}addEventListener(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i?.once){const n=()=>{this.removeEventListener(e,n),this.removeEventListener(e,t)};return this.addEventListener(e,n),n}return()=>this.removeEventListener(e,t)}removeEventListener(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}}class Kt extends gt{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}}function Ae(s,e,t,i,n=5){let r=()=>{};if(!s)return r;const o=a=>{if(a.button===2)return;a.preventDefault(),a.stopPropagation(),s.style.touchAction="none";let u=a.clientX,d=a.clientY,l=!1;const c=f=>{f.preventDefault(),f.stopPropagation();const b=f.clientX,D=f.clientY;if(l||Math.abs(b-u)>=n||Math.abs(D-d)>=n){const{left:P,top:E}=s.getBoundingClientRect();l||(l=!0,t?.(u-P,d-E)),e(b-u,D-d,b-P,D-E),u=b,d=D}},v=f=>{l&&(f.preventDefault(),f.stopPropagation())},h=()=>{s.style.touchAction="",l&&i?.(),r()};document.addEventListener("pointermove",c),document.addEventListener("pointerup",h),document.addEventListener("pointerleave",h),document.addEventListener("click",v,!0),r=()=>{document.removeEventListener("pointermove",c),document.removeEventListener("pointerup",h),document.removeEventListener("pointerleave",h),setTimeout(()=>{document.removeEventListener("click",v,!0)},10)}};return s.addEventListener("pointerdown",o),()=>{r(),s.removeEventListener("pointerdown",o)}}class $e extends gt{constructor(e,t,i=0){var n,r,o,a,u,d,l;super(),this.totalDuration=t,this.numberOfChannels=i,this.minLength=0,this.maxLength=1/0,this.id=e.id||`region-${Math.random().toString(32).slice(2)}`,this.start=this.clampPosition(e.start),this.end=this.clampPosition((n=e.end)!==null&&n!==void 0?n:e.start),this.drag=(r=e.drag)===null||r===void 0||r,this.resize=(o=e.resize)===null||o===void 0||o,this.color=(a=e.color)!==null&&a!==void 0?a:"rgba(0, 0, 0, 0.1)",this.minLength=(u=e.minLength)!==null&&u!==void 0?u:this.minLength,this.maxLength=(d=e.maxLength)!==null&&d!==void 0?d:this.maxLength,this.channelIdx=(l=e.channelIdx)!==null&&l!==void 0?l:-1,this.element=this.initElement(),this.setContent(e.content),this.setPart(),this.renderPosition(),this.initMouseEvents()}clampPosition(e){return Math.max(0,Math.min(this.totalDuration,e))}setPart(){const e=this.start===this.end;this.element.setAttribute("part",`${e?"marker":"region"} ${this.id}`)}addResizeHandles(e){const t=document.createElement("div");t.setAttribute("data-resize","left"),t.setAttribute("style",`
        position: absolute;
        z-index: 2;
        width: 6px;
        height: 100%;
        top: 0;
        left: 0;
        border-left: 2px solid rgba(0, 0, 0, 0.5);
        border-radius: 2px 0 0 2px;
        cursor: ew-resize;
        word-break: keep-all;
      `),t.setAttribute("part","region-handle region-handle-left");const i=t.cloneNode();i.setAttribute("data-resize","right"),i.style.left="",i.style.right="0",i.style.borderRight=i.style.borderLeft,i.style.borderLeft="",i.style.borderRadius="0 2px 2px 0",i.setAttribute("part","region-handle region-handle-right"),e.appendChild(t),e.appendChild(i),Ae(t,n=>this.onResize(n,"start"),()=>null,()=>this.onEndResizing(),1),Ae(i,n=>this.onResize(n,"end"),()=>null,()=>this.onEndResizing(),1)}removeResizeHandles(e){const t=e.querySelector('[data-resize="left"]'),i=e.querySelector('[data-resize="right"]');t&&e.removeChild(t),i&&e.removeChild(i)}initElement(){const e=document.createElement("div"),t=this.start===this.end;let i=0,n=100;return this.channelIdx>=0&&this.channelIdx<this.numberOfChannels&&(n=100/this.numberOfChannels,i=n*this.channelIdx),e.setAttribute("style",`
      position: absolute;
      top: ${i}%;
      height: ${n}%;
      background-color: ${t?"none":this.color};
      border-left: ${t?"2px solid "+this.color:"none"};
      border-radius: 2px;
      box-sizing: border-box;
      transition: background-color 0.2s ease;
      cursor: ${this.drag?"grab":"default"};
      pointer-events: all;
    `),!t&&this.resize&&this.addResizeHandles(e),e}renderPosition(){const e=this.start/this.totalDuration,t=(this.totalDuration-this.end)/this.totalDuration;this.element.style.left=100*e+"%",this.element.style.right=100*t+"%"}initMouseEvents(){const{element:e}=this;e&&(e.addEventListener("click",t=>this.emit("click",t)),e.addEventListener("mouseenter",t=>this.emit("over",t)),e.addEventListener("mouseleave",t=>this.emit("leave",t)),e.addEventListener("dblclick",t=>this.emit("dblclick",t)),Ae(e,t=>this.onMove(t),()=>this.onStartMoving(),()=>this.onEndMoving()))}onStartMoving(){this.drag&&(this.element.style.cursor="grabbing")}onEndMoving(){this.drag&&(this.element.style.cursor="grab",this.emit("update-end"))}_onUpdate(e,t){if(!this.element.parentElement)return;const i=e/this.element.parentElement.clientWidth*this.totalDuration,n=t&&t!=="start"?this.start:this.start+i,r=t&&t!=="end"?this.end:this.end+i,o=r-n;n>=0&&r<=this.totalDuration&&n<=r&&o>=this.minLength&&o<=this.maxLength&&(this.start=n,this.end=r,this.renderPosition(),this.emit("update"))}onMove(e){this.drag&&this._onUpdate(e)}onResize(e,t){this.resize&&this._onUpdate(e,t)}onEndResizing(){this.resize&&this.emit("update-end")}_setTotalDuration(e){this.totalDuration=e,this.renderPosition()}play(){this.emit("play")}setContent(e){var t;if((t=this.content)===null||t===void 0||t.remove(),e){if(typeof e=="string"){this.content=document.createElement("div");const i=this.start===this.end;this.content.style.padding=`0.2em ${i?.2:.4}em`,this.content.textContent=e}else this.content=e;this.content.setAttribute("part","region-content"),this.element.appendChild(this.content)}else this.content=void 0}setOptions(e){var t,i;if(e.color&&(this.color=e.color,this.element.style.backgroundColor=this.color),e.drag!==void 0&&(this.drag=e.drag,this.element.style.cursor=this.drag?"grab":"default"),e.start!==void 0||e.end!==void 0){const n=this.start===this.end;this.start=this.clampPosition((t=e.start)!==null&&t!==void 0?t:this.start),this.end=this.clampPosition((i=e.end)!==null&&i!==void 0?i:n?this.start:this.end),this.renderPosition(),this.setPart()}if(e.content&&this.setContent(e.content),e.id&&(this.id=e.id,this.setPart()),e.resize!==void 0&&e.resize!==this.resize){const n=this.start===this.end;this.resize=e.resize,this.resize&&!n?this.addResizeHandles(this.element):this.removeResizeHandles(this.element)}}remove(){this.emit("remove"),this.element.remove(),this.element=null}}class Ue extends Kt{constructor(e){super(e),this.regions=[],this.regionsContainer=this.initRegionsContainer()}static create(e){return new Ue(e)}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");this.wavesurfer.getWrapper().appendChild(this.regionsContainer);let e=[];this.subscriptions.push(this.wavesurfer.on("timeupdate",t=>{const i=this.regions.filter(n=>n.start<=t&&n.end>=t);i.forEach(n=>{e.includes(n)||this.emit("region-in",n)}),e.forEach(n=>{i.includes(n)||this.emit("region-out",n)}),e=i}))}initRegionsContainer(){const e=document.createElement("div");return e.setAttribute("style",`
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 3;
      pointer-events: none;
    `),e}getRegions(){return this.regions}avoidOverlapping(e){if(!e.content)return;const t=e.content,i=t.getBoundingClientRect().left,n=e.element.scrollWidth,r=this.regions.filter(o=>{if(o===e||!o.content)return!1;const a=o.content.getBoundingClientRect().left,u=o.element.scrollWidth;return i<a+u&&a<i+n}).map(o=>{var a;return((a=o.content)===null||a===void 0?void 0:a.getBoundingClientRect().height)||0}).reduce((o,a)=>o+a,0);t.style.marginTop=`${r}px`}saveRegion(e){this.regionsContainer.appendChild(e.element),this.avoidOverlapping(e),this.regions.push(e);const t=[e.on("update-end",()=>{this.avoidOverlapping(e),this.emit("region-updated",e)}),e.on("play",()=>{var i,n;(i=this.wavesurfer)===null||i===void 0||i.play(),(n=this.wavesurfer)===null||n===void 0||n.setTime(e.start)}),e.on("click",i=>{this.emit("region-clicked",e,i)}),e.on("dblclick",i=>{this.emit("region-double-clicked",e,i)}),e.once("remove",()=>{t.forEach(i=>i()),this.regions=this.regions.filter(i=>i!==e)})];this.subscriptions.push(...t),this.emit("region-created",e)}addRegion(e){var t,i;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const n=this.wavesurfer.getDuration(),r=(i=(t=this.wavesurfer)===null||t===void 0?void 0:t.getDecodedData())===null||i===void 0?void 0:i.numberOfChannels,o=new $e(e,n,r);return n?this.saveRegion(o):this.subscriptions.push(this.wavesurfer.once("ready",a=>{o._setTotalDuration(a),this.saveRegion(o)})),o}enableDragSelection(e){var t,i;const n=(i=(t=this.wavesurfer)===null||t===void 0?void 0:t.getWrapper())===null||i===void 0?void 0:i.querySelector("div");if(!n)return()=>{};let r=null,o=0;return Ae(n,(a,u,d)=>{r&&r._onUpdate(a,d>o?"end":"start")},a=>{var u,d;if(o=a,!this.wavesurfer)return;const l=this.wavesurfer.getDuration(),c=(d=(u=this.wavesurfer)===null||u===void 0?void 0:u.getDecodedData())===null||d===void 0?void 0:d.numberOfChannels,v=this.wavesurfer.getWrapper().clientWidth,h=a/v*l,f=(a+5)/v*l;r=new $e(Object.assign(Object.assign({},e),{start:h,end:f}),l,c),this.regionsContainer.appendChild(r.element)},()=>{r&&(this.saveRegion(r),r=null)})}clearRegions(){this.regions.forEach(e=>e.remove())}destroy(){this.clearRegions(),super.destroy()}}const{SvelteComponent:Jt,check_outros:Qt,create_component:qe,destroy_component:Fe,detach:Zt,empty:$t,flush:ei,group_outros:ti,init:ii,insert:ni,mount_component:xe,safe_not_equal:si,transition_in:Ee,transition_out:Re}=window.__gradio__svelte__internal;function ri(s){let e,t;return e=new Lt({}),{c(){qe(e.$$.fragment)},m(i,n){xe(e,i,n),t=!0},i(i){t||(Ee(e.$$.fragment,i),t=!0)},o(i){Re(e.$$.fragment,i),t=!1},d(i){Fe(e,i)}}}function oi(s){let e,t;return e=new Rt({}),{c(){qe(e.$$.fragment)},m(i,n){xe(e,i,n),t=!0},i(i){t||(Ee(e.$$.fragment,i),t=!0)},o(i){Re(e.$$.fragment,i),t=!1},d(i){Fe(e,i)}}}function li(s){let e,t;return e=new Et({}),{c(){qe(e.$$.fragment)},m(i,n){xe(e,i,n),t=!0},i(i){t||(Ee(e.$$.fragment,i),t=!0)},o(i){Re(e.$$.fragment,i),t=!1},d(i){Fe(e,i)}}}function ai(s){let e,t,i,n;const r=[li,oi,ri],o=[];function a(u,d){return u[0]==0?0:u[0]<.5?1:u[0]>=.5?2:-1}return~(e=a(s))&&(t=o[e]=r[e](s)),{c(){t&&t.c(),i=$t()},m(u,d){~e&&o[e].m(u,d),ni(u,i,d),n=!0},p(u,[d]){let l=e;e=a(u),e!==l&&(t&&(ti(),Re(o[l],1,1,()=>{o[l]=null}),Qt()),~e?(t=o[e],t||(t=o[e]=r[e](u),t.c()),Ee(t,1),t.m(i.parentNode,i)):t=null)},i(u){n||(Ee(t),n=!0)},o(u){Re(t),n=!1},d(u){u&&Zt(i),~e&&o[e].d(u)}}}function ui(s,e,t){let{currentVolume:i}=e;return s.$$set=n=>{"currentVolume"in n&&t(0,i=n.currentVolume)},[i]}class di extends Jt{constructor(e){super(),ii(this,e,ui,ai,si,{currentVolume:0})}get currentVolume(){return this.$$.ctx[0]}set currentVolume(e){this.$$set({currentVolume:e}),ei()}}const{SvelteComponent:ci,attr:_e,binding_callbacks:hi,detach:fi,element:mi,flush:je,init:gi,insert:_i,listen:et,noop:tt,run_all:pi,safe_not_equal:vi}=window.__gradio__svelte__internal,{onMount:bi}=window.__gradio__svelte__internal;function wi(s){let e,t,i;return{c(){e=mi("input"),_e(e,"id","volume"),_e(e,"class","volume-slider svelte-wuo8j5"),_e(e,"type","range"),_e(e,"min","0"),_e(e,"max","1"),_e(e,"step","0.01"),e.value=s[0]},m(n,r){_i(n,e,r),s[4](e),t||(i=[et(e,"focusout",s[5]),et(e,"input",s[6])],t=!0)},p(n,[r]){r&1&&(e.value=n[0])},i:tt,o:tt,d(n){n&&fi(e),s[4](null),t=!1,pi(i)}}}function yi(s,e,t){let{currentVolume:i=1}=e,{show_volume_slider:n=!1}=e,{waveform:r}=e,o;bi(()=>{a()});const a=()=>{let c=o;c&&(c.style.background=`linear-gradient(to right, var(--color-accent) ${i*100}%, var(--neutral-400) ${i*100}%)`)};function u(c){hi[c?"unshift":"push"](()=>{o=c,t(3,o)})}const d=()=>t(1,n=!1),l=c=>{c.target instanceof HTMLInputElement&&(t(0,i=parseFloat(c.target.value)),r?.setVolume(i))};return s.$$set=c=>{"currentVolume"in c&&t(0,i=c.currentVolume),"show_volume_slider"in c&&t(1,n=c.show_volume_slider),"waveform"in c&&t(2,r=c.waveform)},s.$$.update=()=>{s.$$.dirty&1&&a()},[i,n,r,o,u,d,l]}class ki extends ci{constructor(e){super(),gi(this,e,yi,wi,vi,{currentVolume:0,show_volume_slider:1,waveform:2})}get currentVolume(){return this.$$.ctx[0]}set currentVolume(e){this.$$set({currentVolume:e}),je()}get show_volume_slider(){return this.$$.ctx[1]}set show_volume_slider(e){this.$$set({show_volume_slider:e}),je()}get waveform(){return this.$$.ctx[2]}set waveform(e){this.$$set({waveform:e}),je()}}const{SvelteComponent:Ci,add_flush_callback:it,append:B,attr:T,bind:nt,binding_callbacks:st,check_outros:be,create_component:te,destroy_component:ie,detach:ne,element:q,empty:Ei,flush:I,group_outros:we,init:Ri,insert:se,listen:$,mount_component:re,noop:ye,run_all:_t,safe_not_equal:Li,set_data:Si,set_style:ze,space:ee,text:rt,toggle_class:ot,transition_in:W,transition_out:V}=window.__gradio__svelte__internal;function lt(s){let e,t,i,n;function r(u){s[30](u)}function o(u){s[31](u)}let a={waveform:s[3]};return s[14]!==void 0&&(a.currentVolume=s[14]),s[1]!==void 0&&(a.show_volume_slider=s[1]),e=new ki({props:a}),st.push(()=>nt(e,"currentVolume",r)),st.push(()=>nt(e,"show_volume_slider",o)),{c(){te(e.$$.fragment)},m(u,d){re(e,u,d),n=!0},p(u,d){const l={};d[0]&8&&(l.waveform=u[3]),!t&&d[0]&16384&&(t=!0,l.currentVolume=u[14],it(()=>t=!1)),!i&&d[0]&2&&(i=!0,l.show_volume_slider=u[1],it(()=>i=!1)),e.$set(l)},i(u){n||(W(e.$$.fragment,u),n=!0)},o(u){V(e.$$.fragment,u),n=!1},d(u){ie(e,u)}}}function Di(s){let e,t;return e=new Pt({}),{c(){te(e.$$.fragment)},m(i,n){re(e,i,n),t=!0},i(i){t||(W(e.$$.fragment,i),t=!0)},o(i){V(e.$$.fragment,i),t=!1},d(i){ie(e,i)}}}function Mi(s){let e,t;return e=new Mt({}),{c(){te(e.$$.fragment)},m(i,n){re(e,i,n),t=!0},i(i){t||(W(e.$$.fragment,i),t=!0)},o(i){V(e.$$.fragment,i),t=!1},d(i){ie(e,i)}}}function at(s){let e,t,i,n,r;return t=new Tt({}),{c(){e=q("button"),te(t.$$.fragment),T(e,"class","action icon cc-button svelte-1joklbr"),T(e,"data-testid","subtitles-toggle"),ze(e,"color",s[2]?"var(--color-accent)":"var(--neutral-400)")},m(o,a){se(o,e,a),re(t,e,null),i=!0,n||(r=$(e,"click",s[19]),n=!0)},p(o,a){(!i||a[0]&4)&&ze(e,"color",o[2]?"var(--color-accent)":"var(--neutral-400)")},i(o){i||(W(t.$$.fragment,o),i=!0)},o(o){V(t.$$.fragment,o),i=!1},d(o){o&&ne(e),ie(t),n=!1,r()}}}function ut(s){let e,t,i,n,r,o=s[7]&&s[0]===""&&dt(s);const a=[Ti,Pi],u=[];function d(l,c){return l[0]===""?0:1}return t=d(s),i=u[t]=a[t](s),{c(){o&&o.c(),e=ee(),i.c(),n=Ei()},m(l,c){o&&o.m(l,c),se(l,e,c),u[t].m(l,c),se(l,n,c),r=!0},p(l,c){l[7]&&l[0]===""?o?(o.p(l,c),c[0]&129&&W(o,1)):(o=dt(l),o.c(),W(o,1),o.m(e.parentNode,e)):o&&(we(),V(o,1,1,()=>{o=null}),be());let v=t;t=d(l),t===v?u[t].p(l,c):(we(),V(u[v],1,1,()=>{u[v]=null}),be(),i=u[t],i?i.p(l,c):(i=u[t]=a[t](l),i.c()),W(i,1),i.m(n.parentNode,n))},i(l){r||(W(o),W(i),r=!0)},o(l){V(o),V(i),r=!1},d(l){l&&(ne(e),ne(n)),o&&o.d(l),u[t].d(l)}}}function dt(s){let e,t,i,n,r;return t=new At({}),{c(){e=q("button"),te(t.$$.fragment),T(e,"class","action icon svelte-1joklbr"),T(e,"aria-label","Reset audio")},m(o,a){se(o,e,a),re(t,e,null),i=!0,n||(r=$(e,"click",s[36]),n=!0)},p:ye,i(o){i||(W(t.$$.fragment,o),i=!0)},o(o){V(t.$$.fragment,o),i=!1},d(o){o&&ne(e),ie(t),n=!1,r()}}}function Pi(s){let e,t,i,n,r;return{c(){e=q("button"),e.textContent="Trim",t=ee(),i=q("button"),i.textContent="Cancel",T(e,"class","text-button svelte-1joklbr"),T(i,"class","text-button svelte-1joklbr")},m(o,a){se(o,e,a),se(o,t,a),se(o,i,a),n||(r=[$(e,"click",s[16]),$(i,"click",s[18])],n=!0)},p:ye,i:ye,o:ye,d(o){o&&(ne(e),ne(t),ne(i)),n=!1,_t(r)}}}function Ti(s){let e,t,i,n,r;return t=new Wt({}),{c(){e=q("button"),te(t.$$.fragment),T(e,"class","action icon svelte-1joklbr"),T(e,"aria-label","Trim audio to selection")},m(o,a){se(o,e,a),re(t,e,null),i=!0,n||(r=$(e,"click",s[18]),n=!0)},p:ye,i(o){i||(W(t.$$.fragment,o),i=!0)},o(o){V(t.$$.fragment,o),i=!1},d(o){o&&ne(e),ie(t),n=!1,r()}}}function Ai(s){let e,t,i,n,r,o,a,u,d,l,c,v,h,f,b,D,P,E,p,L,C,w,y,A,j,H,g,R,S,x,oe;n=new di({props:{currentVolume:s[14]}});let M=s[1]&&lt(s);b=new St({});const ae=[Mi,Di],K=[];function he(k,N){return k[6]?0:1}p=he(s),L=K[p]=ae[p](s),A=new Dt({});let O=s[12]&&at(s),z=s[11]&&s[8]&&ut(s);return{c(){e=q("div"),t=q("div"),i=q("button"),te(n.$$.fragment),r=ee(),M&&M.c(),o=ee(),a=q("button"),u=q("span"),d=rt(s[13]),l=rt("x"),v=ee(),h=q("div"),f=q("button"),te(b.$$.fragment),P=ee(),E=q("button"),L.c(),w=ee(),y=q("button"),te(A.$$.fragment),H=ee(),g=q("div"),O&&O.c(),R=ee(),z&&z.c(),T(i,"class","action icon volume svelte-1joklbr"),T(i,"aria-label","Adjust volume"),ze(i,"color",s[1]?"var(--color-accent)":"var(--neutral-400)"),T(a,"class","playback icon svelte-1joklbr"),T(a,"aria-label",c=`Adjust playback speed to ${s[15][(s[15].indexOf(s[13])+1)%s[15].length]}x`),ot(a,"hidden",s[1]),T(t,"class","control-wrapper svelte-1joklbr"),T(f,"class","rewind icon svelte-1joklbr"),T(f,"aria-label",D=`Skip backwards by ${ve(s[4],s[10].skip_length)} seconds`),T(E,"class","play-pause-button icon svelte-1joklbr"),T(E,"aria-label",C=s[6]?s[5]("audio.pause"):s[5]("audio.play")),T(y,"class","skip icon svelte-1joklbr"),T(y,"aria-label",j="Skip forward by "+ve(s[4],s[10].skip_length)+" seconds"),T(h,"class","play-pause-wrapper svelte-1joklbr"),T(g,"class","settings-wrapper svelte-1joklbr"),T(e,"class","controls svelte-1joklbr"),T(e,"data-testid","waveform-controls")},m(k,N){se(k,e,N),B(e,t),B(t,i),re(n,i,null),B(t,r),M&&M.m(t,null),B(t,o),B(t,a),B(a,u),B(u,d),B(u,l),B(e,v),B(e,h),B(h,f),re(b,f,null),B(h,P),B(h,E),K[p].m(E,null),B(h,w),B(h,y),re(A,y,null),B(e,H),B(e,g),O&&O.m(g,null),B(g,R),z&&z.m(g,null),S=!0,x||(oe=[$(i,"click",s[29]),$(a,"click",s[32]),$(f,"click",s[33]),$(E,"click",s[34]),$(y,"click",s[35])],x=!0)},p(k,N){const fe={};N[0]&16384&&(fe.currentVolume=k[14]),n.$set(fe),N[0]&2&&ze(i,"color",k[1]?"var(--color-accent)":"var(--neutral-400)"),k[1]?M?(M.p(k,N),N[0]&2&&W(M,1)):(M=lt(k),M.c(),W(M,1),M.m(t,o)):M&&(we(),V(M,1,1,()=>{M=null}),be()),(!S||N[0]&8192)&&Si(d,k[13]),(!S||N[0]&8192&&c!==(c=`Adjust playback speed to ${k[15][(k[15].indexOf(k[13])+1)%k[15].length]}x`))&&T(a,"aria-label",c),(!S||N[0]&2)&&ot(a,"hidden",k[1]),(!S||N[0]&1040&&D!==(D=`Skip backwards by ${ve(k[4],k[10].skip_length)} seconds`))&&T(f,"aria-label",D);let ue=p;p=he(k),p!==ue&&(we(),V(K[ue],1,1,()=>{K[ue]=null}),be(),L=K[p],L||(L=K[p]=ae[p](k),L.c()),W(L,1),L.m(E,null)),(!S||N[0]&96&&C!==(C=k[6]?k[5]("audio.pause"):k[5]("audio.play")))&&T(E,"aria-label",C),(!S||N[0]&1040&&j!==(j="Skip forward by "+ve(k[4],k[10].skip_length)+" seconds"))&&T(y,"aria-label",j),k[12]?O?(O.p(k,N),N[0]&4096&&W(O,1)):(O=at(k),O.c(),W(O,1),O.m(g,R)):O&&(we(),V(O,1,1,()=>{O=null}),be()),k[11]&&k[8]?z?(z.p(k,N),N[0]&2304&&W(z,1)):(z=ut(k),z.c(),W(z,1),z.m(g,null)):z&&(we(),V(z,1,1,()=>{z=null}),be())},i(k){S||(W(n.$$.fragment,k),W(M),W(b.$$.fragment,k),W(L),W(A.$$.fragment,k),W(O),W(z),S=!0)},o(k){V(n.$$.fragment,k),V(M),V(b.$$.fragment,k),V(L),V(A.$$.fragment,k),V(O),V(z),S=!1},d(k){k&&ne(e),ie(n),M&&M.d(),ie(b),K[p].d(),ie(A),O&&O.d(),z&&z.d(),x=!1,_t(oe)}}}function Wi(s,e,t){let{waveform:i}=e,{audio_duration:n}=e,{i18n:r}=e,{playing:o}=e,{show_redo:a=!1}=e,{interactive:u=!1}=e,{handle_trim_audio:d}=e,{mode:l=""}=e,{container:c}=e,{handle_reset_value:v}=e,{waveform_options:h={}}=e,{trim_region_settings:f={}}=e,{show_volume_slider:b=!1}=e,{editable:D=!0}=e,{subtitles_toggle:P=!0}=e,{show_subtitles:E=!1}=e,{trimDuration:p=0}=e,L=[.5,1,1.5,2],C=L[1],w=null,y=null,A,j,H="",g=1;const R=()=>{w&&(t(25,y=w?.addRegion({start:n/4,end:n/2,...f})),t(20,p=y.end-y.start))},S=()=>{if(i&&w&&y){const _=y.start,le=y.end;d(_,le),t(0,l=""),t(25,y=null)}},x=()=>{w?.getRegions().forEach(_=>{_.remove()}),w?.clearRegions()},oe=()=>{x(),l==="edit"?t(0,l=""):(t(0,l="edit"),R())},M=()=>{t(2,P=!P)},ae=(_,le)=>{let de,ce;y&&(_==="left"?le==="ArrowLeft"?(de=y.start-.05,ce=y.end):(de=y.start+.05,ce=y.end):le==="ArrowLeft"?(de=y.start,ce=y.end-.05):(de=y.start,ce=y.end+.05),y.setOptions({start:de,end:ce}),t(20,p=y.end-y.start))},K=()=>t(1,b=!b);function he(_){g=_,t(14,g)}function O(_){b=_,t(1,b)}const z=()=>{t(13,C=L[(L.indexOf(C)+1)%L.length]),i?.setPlaybackRate(C)},k=()=>i?.skip(ve(n,h.skip_length)*-1),N=()=>i?.playPause(),fe=()=>i?.skip(ve(n,h.skip_length)),ue=()=>{v(),x(),t(0,l="")};return s.$$set=_=>{"waveform"in _&&t(3,i=_.waveform),"audio_duration"in _&&t(4,n=_.audio_duration),"i18n"in _&&t(5,r=_.i18n),"playing"in _&&t(6,o=_.playing),"show_redo"in _&&t(7,a=_.show_redo),"interactive"in _&&t(8,u=_.interactive),"handle_trim_audio"in _&&t(21,d=_.handle_trim_audio),"mode"in _&&t(0,l=_.mode),"container"in _&&t(22,c=_.container),"handle_reset_value"in _&&t(9,v=_.handle_reset_value),"waveform_options"in _&&t(10,h=_.waveform_options),"trim_region_settings"in _&&t(23,f=_.trim_region_settings),"show_volume_slider"in _&&t(1,b=_.show_volume_slider),"editable"in _&&t(11,D=_.editable),"subtitles_toggle"in _&&t(2,P=_.subtitles_toggle),"show_subtitles"in _&&t(12,E=_.show_subtitles),"trimDuration"in _&&t(20,p=_.trimDuration)},s.$$.update=()=>{if(s.$$.dirty[0]&4194312&&t(24,w=c&&i?i.registerPlugin(Ue.create()):null),s.$$.dirty[0]&16777216&&w?.on("region-out",_=>{_.play()}),s.$$.dirty[0]&16777216&&w?.on("region-updated",_=>{t(20,p=_.end-_.start)}),s.$$.dirty[0]&16777216&&w?.on("region-clicked",(_,le)=>{le.stopPropagation(),t(25,y=_),_.play()}),s.$$.dirty[0]&255852544&&y){const _=c.children[0].shadowRoot;t(27,j=_.querySelector('[data-resize="right"]')),t(26,A=_.querySelector('[data-resize="left"]')),A&&j&&(A.setAttribute("role","button"),j.setAttribute("role","button"),A?.setAttribute("aria-label","Drag to adjust start time"),j?.setAttribute("aria-label","Drag to adjust end time"),A?.setAttribute("tabindex","0"),j?.setAttribute("tabindex","0"),A.addEventListener("focus",()=>{w&&t(28,H="left")}),j.addEventListener("focus",()=>{w&&t(28,H="right")}))}s.$$.dirty[0]&285212672&&w&&window.addEventListener("keydown",_=>{_.key==="ArrowLeft"?ae(H,"ArrowLeft"):_.key==="ArrowRight"&&ae(H,"ArrowRight")})},[l,b,P,i,n,r,o,a,u,v,h,D,E,C,g,L,S,x,oe,M,p,d,c,f,w,y,A,j,H,K,he,O,z,k,N,fe,ue]}class zi extends Ci{constructor(e){super(),Ri(this,e,Wi,Ai,Li,{waveform:3,audio_duration:4,i18n:5,playing:6,show_redo:7,interactive:8,handle_trim_audio:21,mode:0,container:22,handle_reset_value:9,waveform_options:10,trim_region_settings:23,show_volume_slider:1,editable:11,subtitles_toggle:2,show_subtitles:12,trimDuration:20},null,[-1,-1])}get waveform(){return this.$$.ctx[3]}set waveform(e){this.$$set({waveform:e}),I()}get audio_duration(){return this.$$.ctx[4]}set audio_duration(e){this.$$set({audio_duration:e}),I()}get i18n(){return this.$$.ctx[5]}set i18n(e){this.$$set({i18n:e}),I()}get playing(){return this.$$.ctx[6]}set playing(e){this.$$set({playing:e}),I()}get show_redo(){return this.$$.ctx[7]}set show_redo(e){this.$$set({show_redo:e}),I()}get interactive(){return this.$$.ctx[8]}set interactive(e){this.$$set({interactive:e}),I()}get handle_trim_audio(){return this.$$.ctx[21]}set handle_trim_audio(e){this.$$set({handle_trim_audio:e}),I()}get mode(){return this.$$.ctx[0]}set mode(e){this.$$set({mode:e}),I()}get container(){return this.$$.ctx[22]}set container(e){this.$$set({container:e}),I()}get handle_reset_value(){return this.$$.ctx[9]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),I()}get waveform_options(){return this.$$.ctx[10]}set waveform_options(e){this.$$set({waveform_options:e}),I()}get trim_region_settings(){return this.$$.ctx[23]}set trim_region_settings(e){this.$$set({trim_region_settings:e}),I()}get show_volume_slider(){return this.$$.ctx[1]}set show_volume_slider(e){this.$$set({show_volume_slider:e}),I()}get editable(){return this.$$.ctx[11]}set editable(e){this.$$set({editable:e}),I()}get subtitles_toggle(){return this.$$.ctx[2]}set subtitles_toggle(e){this.$$set({subtitles_toggle:e}),I()}get show_subtitles(){return this.$$.ctx[12]}set show_subtitles(e){this.$$set({show_subtitles:e}),I()}get trimDuration(){return this.$$.ctx[20]}set trimDuration(e){this.$$set({trimDuration:e}),I()}}const{SvelteComponent:Oi,add_flush_callback:Pe,append:G,attr:U,bind:Te,binding_callbacks:Z,bubble:Hi,check_outros:Ni,create_component:Xe,destroy_component:Ge,detach:ke,element:Q,empty:Vi,flush:X,group_outros:ji,init:Bi,insert:Ce,listen:Be,mount_component:Ye,run_all:Ii,safe_not_equal:Ui,set_data:qi,set_style:ct,space:pe,text:Fi,toggle_class:ht,transition_in:Le,transition_out:Se}=window.__gradio__svelte__internal,{onMount:xi}=window.__gradio__svelte__internal,{createEventDispatcher:Xi}=window.__gradio__svelte__internal;function Gi(s){let e,t,i,n,r,o,a,u,d,l,c,v,h,f,b,D,P,E,p,L,C=s[0]==="edit"&&s[22]>0&&ft(s);function w(g){s[37](g)}function y(g){s[38](g)}function A(g){s[39](g)}function j(g){s[40](g)}let H={container:s[11],waveform:s[12],playing:s[17],audio_duration:s[21],i18n:s[4],interactive:s[5],handle_trim_audio:s[25],show_redo:s[5],handle_reset_value:s[10],waveform_options:s[9],trim_region_settings:s[7],editable:s[6],show_subtitles:s[2]!==null};return s[0]!==void 0&&(H.mode=s[0]),s[22]!==void 0&&(H.trimDuration=s[22]),s[23]!==void 0&&(H.show_volume_slider=s[23]),s[14]!==void 0&&(H.subtitles_toggle=s[14]),f=new zi({props:H}),Z.push(()=>Te(f,"mode",w)),Z.push(()=>Te(f,"trimDuration",y)),Z.push(()=>Te(f,"show_volume_slider",A)),Z.push(()=>Te(f,"subtitles_toggle",j)),{c(){e=Q("div"),t=Q("div"),i=Q("div"),n=pe(),r=Q("div"),o=Q("time"),o.textContent="0:00",a=pe(),u=Q("div"),C&&C.c(),d=pe(),l=Q("time"),l.textContent="0:00",c=pe(),v=Q("div"),h=pe(),Xe(f.$$.fragment),U(i,"id","waveform"),U(i,"class","svelte-1vm10g7"),ct(i,"height",s[11]?null:"58px"),U(t,"class","waveform-container svelte-1vm10g7"),U(o,"id","time"),U(o,"class","svelte-1vm10g7"),U(l,"id","duration"),U(l,"class","svelte-1vm10g7"),U(r,"class","timestamps svelte-1vm10g7"),U(v,"class","subtitle-display svelte-1vm10g7"),U(v,"data-testid","subtitle-display"),U(e,"class","component-wrapper svelte-1vm10g7"),U(e,"data-testid",p=s[3]?"waveform-"+s[3]:"unlabelled-audio")},m(g,R){Ce(g,e,R),G(e,t),G(t,i),s[33](i),G(e,n),G(e,r),G(r,o),s[34](o),G(r,a),G(r,u),C&&C.m(u,null),G(u,d),G(u,l),s[35](l),G(e,c),G(e,v),s[36](v),G(e,h),Ye(f,e,null),s[41](e),L=!0},p(g,R){R[0]&2048&&ct(i,"height",g[11]?null:"58px"),g[0]==="edit"&&g[22]>0?C?C.p(g,R):(C=ft(g),C.c(),C.m(u,d)):C&&(C.d(1),C=null);const S={};R[0]&2048&&(S.container=g[11]),R[0]&4096&&(S.waveform=g[12]),R[0]&131072&&(S.playing=g[17]),R[0]&2097152&&(S.audio_duration=g[21]),R[0]&16&&(S.i18n=g[4]),R[0]&32&&(S.interactive=g[5]),R[0]&32&&(S.show_redo=g[5]),R[0]&1024&&(S.handle_reset_value=g[10]),R[0]&512&&(S.waveform_options=g[9]),R[0]&128&&(S.trim_region_settings=g[7]),R[0]&64&&(S.editable=g[6]),R[0]&4&&(S.show_subtitles=g[2]!==null),!b&&R[0]&1&&(b=!0,S.mode=g[0],Pe(()=>b=!1)),!D&&R[0]&4194304&&(D=!0,S.trimDuration=g[22],Pe(()=>D=!1)),!P&&R[0]&8388608&&(P=!0,S.show_volume_slider=g[23],Pe(()=>P=!1)),!E&&R[0]&16384&&(E=!0,S.subtitles_toggle=g[14],Pe(()=>E=!1)),f.$set(S),(!L||R[0]&8&&p!==(p=g[3]?"waveform-"+g[3]:"unlabelled-audio"))&&U(e,"data-testid",p)},i(g){L||(Le(f.$$.fragment,g),L=!0)},o(g){Se(f.$$.fragment,g),L=!1},d(g){g&&ke(e),s[33](null),s[34](null),C&&C.d(),s[35](null),s[36](null),Ge(f),s[41](null)}}}function Yi(s){let e,t;return e=new zt({props:{size:"small",$$slots:{default:[Ki]},$$scope:{ctx:s}}}),{c(){Xe(e.$$.fragment)},m(i,n){Ye(e,i,n),t=!0},p(i,n){const r={};n[1]&524288&&(r.$$scope={dirty:n,ctx:i}),e.$set(r)},i(i){t||(Le(e.$$.fragment,i),t=!0)},o(i){Se(e.$$.fragment,i),t=!1},d(i){Ge(e,i)}}}function ft(s){let e,t=We(s[22])+"",i;return{c(){e=Q("time"),i=Fi(t),U(e,"id","trim-duration"),U(e,"class","svelte-1vm10g7")},m(n,r){Ce(n,e,r),G(e,i)},p(n,r){r[0]&4194304&&t!==(t=We(n[22])+"")&&qi(i,t)},d(n){n&&ke(e)}}}function Ki(s){let e,t;return e=new Ot({}),{c(){Xe(e.$$.fragment)},m(i,n){Ye(e,i,n),t=!0},i(i){t||(Le(e.$$.fragment,i),t=!0)},o(i){Se(e.$$.fragment,i),t=!1},d(i){Ge(e,i)}}}function Ji(s){let e,t,i,n,r,o,a,u,d;const l=[Yi,Gi],c=[];function v(h,f){return h[1]===null?0:h[15]?1:-1}return~(n=v(s))&&(r=c[n]=l[n](s)),{c(){e=Q("audio"),i=pe(),r&&r.c(),o=Vi(),U(e,"class","standard-player svelte-1vm10g7"),e.controls=!0,e.autoplay=t=s[8].autoplay,U(e,"preload","metadata"),ht(e,"hidden",s[15])},m(h,f){Ce(h,e,f),s[30](e),Ce(h,i,f),~n&&c[n].m(h,f),Ce(h,o,f),a=!0,u||(d=[Be(e,"load",s[29]),Be(e,"ended",s[31]),Be(e,"play",s[32])],u=!0)},p(h,f){(!a||f[0]&256&&t!==(t=h[8].autoplay))&&(e.autoplay=t),(!a||f[0]&32768)&&ht(e,"hidden",h[15]);let b=n;n=v(h),n===b?~n&&c[n].p(h,f):(r&&(ji(),Se(c[b],1,1,()=>{c[b]=null}),Ni()),~n?(r=c[n],r?r.p(h,f):(r=c[n]=l[n](h),r.c()),Le(r,1),r.m(o.parentNode,o)):r=null)},i(h){a||(Le(r),a=!0)},o(h){Se(r),a=!1},d(h){h&&(ke(e),ke(i),ke(o)),s[30](null),~n&&c[n].d(h),u=!1,Ii(d)}}}function Qi(s){const e=s.split(`
`),t=[];for(let i=0;i<e.length;i++){const n=e[i].trim();if(n.includes(" --> ")){const[r,o]=n.split(" --> "),a=mt(r),u=mt(o);let d="";for(let l=i+1;l<e.length&&e[l].trim()!=="";l++)d&&(d+=" "),d+=e[l].trim();d&&t.push({start:a,end:u,text:d})}}return t}function mt(s){const e=s.split(":");if(e.length===3){const t=parseInt(e[0]),i=parseInt(e[1]),n=parseFloat(e[2]);return t*3600+i*60+n}return 0}function Zi(s,e,t){let i,n,{value:r=null}=e,{subtitles:o=null}=e,{label:a}=e,{i18n:u}=e,{dispatch_blob:d=()=>Promise.resolve()}=e,{interactive:l=!1}=e,{editable:c=!0}=e,{trim_region_settings:v={}}=e,{waveform_settings:h}=e,{waveform_options:f}=e,{mode:b=""}=e,{loop:D}=e,{handle_reset_value:P=()=>{}}=e,E,p,L,C=!1,w,y,A,j,H=0,g=!1,R,S=!1,x=!0,oe=[];const M=Xi(),ae=()=>{t(12,p=Ie.create({container:E,...h})),o&&p&&(x?z(p,o):k()),r?.url&&p&&p.load(r?.url),p?.on("decode",m=>{t(21,j=m),A&&t(20,A.textContent=We(m),A)}),p?.on("timeupdate",m=>y&&t(19,y.textContent=We(m),y)),p?.on("ready",()=>{h.autoplay?p?.play():p?.stop()}),p?.on("finish",()=>{D?p?.play():(t(17,C=!1),M("stop"))}),p?.on("pause",()=>{t(17,C=!1),M("pause")}),p?.on("play",()=>{t(17,C=!0),M("play")}),p?.on("load",()=>{M("load")})},K=async(m,F)=>{t(0,b="");const J=p?.getDecodedData();J&&await Yt(J,m,F,h.sampleRate).then(async Y=>{await d([Y],"change"),p?.destroy(),t(11,E.innerHTML="",E)}),M("edit")};async function he(m){S=!1,f.show_recording_waveform?p?.load(m):R&&t(13,R.src=m,R)}function O(m){if(!(!m||!m.is_stream||!m.url))if(me.isSupported()&&!S){const F=new me({maxBufferLength:1,maxMaxBufferLength:1,lowLatencyMode:!0});F.loadSource(m.url),F.attachMedia(R),F.on(me.Events.MANIFEST_PARSED,function(){h.autoplay&&R.play()}),F.on(me.Events.ERROR,function(J,Y){if(console.error("HLS error:",J,Y),Y.fatal)switch(Y.type){case me.ErrorTypes.NETWORK_ERROR:console.error("Fatal network error encountered, trying to recover"),F.startLoad();break;case me.ErrorTypes.MEDIA_ERROR:console.error("Fatal media error encountered, trying to recover"),F.recoverMediaError();break;default:console.error("Fatal error, cannot recover"),F.destroy();break}}),S=!0}else S||(t(13,R.src=m.url,R),h.autoplay&&R.play(),S=!0)}xi(()=>{window.addEventListener("keydown",m=>{!p||g||!(L&&L.contains(document.activeElement))||(m.key==="ArrowRight"&&b!=="edit"?Ze(p,.1):m.key==="ArrowLeft"&&b!=="edit"&&Ze(p,-.1))})});async function z(m,F){N();try{let J;if(Array.isArray(F))J=F;else{const De=await(await fetch(F)).text();J=Qi(De)}if(J.length>0){let Y="";if(w){t(18,w.style.display="",w);const De=Ke=>{const Me=J.find(Je=>Ke>=Je.start&&Ke<=Je.end);Me&&Me.text!==Y?(Y=Me.text,t(18,w.textContent=Y,w)):!Me&&Y!==""&&(Y="",t(18,w.textContent="",w))};m.on("audioprocess",De),oe.push(()=>{m.un("audioprocess",De)})}}}catch{}}function k(){w&&t(18,w.style.display="none",w)}function N(){w&&t(18,w.textContent="",w),oe.forEach(m=>m()),oe=[]}function fe(m){Hi.call(this,s,m)}function ue(m){Z[m?"unshift":"push"](()=>{R=m,t(13,R)})}const _=()=>M("stop"),le=()=>M("play");function de(m){Z[m?"unshift":"push"](()=>{E=m,t(11,E),t(15,n),t(12,p),t(9,f),t(1,r)})}function ce(m){Z[m?"unshift":"push"](()=>{y=m,t(19,y)})}function pt(m){Z[m?"unshift":"push"](()=>{A=m,t(20,A)})}function vt(m){Z[m?"unshift":"push"](()=>{w=m,t(18,w)})}function bt(m){b=m,t(0,b)}function wt(m){H=m,t(22,H)}function yt(m){g=m,t(23,g)}function kt(m){x=m,t(14,x)}function Ct(m){Z[m?"unshift":"push"](()=>{L=m,t(16,L)})}return s.$$set=m=>{"value"in m&&t(1,r=m.value),"subtitles"in m&&t(2,o=m.subtitles),"label"in m&&t(3,a=m.label),"i18n"in m&&t(4,u=m.i18n),"dispatch_blob"in m&&t(26,d=m.dispatch_blob),"interactive"in m&&t(5,l=m.interactive),"editable"in m&&t(6,c=m.editable),"trim_region_settings"in m&&t(7,v=m.trim_region_settings),"waveform_settings"in m&&t(8,h=m.waveform_settings),"waveform_options"in m&&t(9,f=m.waveform_options),"mode"in m&&t(0,b=m.mode),"loop"in m&&t(27,D=m.loop),"handle_reset_value"in m&&t(10,P=m.handle_reset_value)},s.$$.update=()=>{s.$$.dirty[0]&2&&t(28,i=r?.url),s.$$.dirty[0]&514&&t(15,n=f.show_recording_waveform&&!r?.is_stream),s.$$.dirty[0]&38912&&n&&E!==void 0&&E!==null&&(p!==void 0&&p.destroy(),t(11,E.innerHTML="",E),ae(),t(17,C=!1)),s.$$.dirty[0]&20484&&o&&p&&(x?z(p,o):k()),s.$$.dirty[0]&268443648&&R&&i&&he(i),s.$$.dirty[0]&8194&&R&&r?.is_stream&&O(r)},[b,r,o,a,u,l,c,v,h,f,P,E,p,R,x,n,L,C,w,y,A,j,H,g,M,K,d,D,i,fe,ue,_,le,de,ce,pt,vt,bt,wt,yt,kt,Ct]}class nn extends Oi{constructor(e){super(),Bi(this,e,Zi,Ji,Ui,{value:1,subtitles:2,label:3,i18n:4,dispatch_blob:26,interactive:5,editable:6,trim_region_settings:7,waveform_settings:8,waveform_options:9,mode:0,loop:27,handle_reset_value:10},null,[-1,-1])}get value(){return this.$$.ctx[1]}set value(e){this.$$set({value:e}),X()}get subtitles(){return this.$$.ctx[2]}set subtitles(e){this.$$set({subtitles:e}),X()}get label(){return this.$$.ctx[3]}set label(e){this.$$set({label:e}),X()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),X()}get dispatch_blob(){return this.$$.ctx[26]}set dispatch_blob(e){this.$$set({dispatch_blob:e}),X()}get interactive(){return this.$$.ctx[5]}set interactive(e){this.$$set({interactive:e}),X()}get editable(){return this.$$.ctx[6]}set editable(e){this.$$set({editable:e}),X()}get trim_region_settings(){return this.$$.ctx[7]}set trim_region_settings(e){this.$$set({trim_region_settings:e}),X()}get waveform_settings(){return this.$$.ctx[8]}set waveform_settings(e){this.$$set({waveform_settings:e}),X()}get waveform_options(){return this.$$.ctx[9]}set waveform_options(e){this.$$set({waveform_options:e}),X()}get mode(){return this.$$.ctx[0]}set mode(e){this.$$set({mode:e}),X()}get loop(){return this.$$.ctx[27]}set loop(e){this.$$set({loop:e}),X()}get handle_reset_value(){return this.$$.ctx[10]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),X()}}export{nn as A,zi as W,Ie as a,Yt as p,Ze as s};
//# sourceMappingURL=AudioPlayer-BYiM-y_F.js.map
